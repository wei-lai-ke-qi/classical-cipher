<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>古典密码加密工具</title>
    <style>
        .top {
            width: 100%;
            height: 100px;
            background-color: #DDD;
            display: flex;
            justify-content: left;
            align-items: center;
        }

        /* From Uiverse.io by CristianMontoya98 */
        .btn {
            width: 6.5em;
            height: 2.3em;
            margin: 0.5em;
            background: black;
            color: white;
            border: none;
            border-radius: 0.625em;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            position: relative;
            z-index: 1;
            overflow: hidden;
        }

        button:hover {
            color: black;
        }

        button:after {
            content: "";
            background: white;
            position: absolute;
            z-index: -1;
            left: -20%;
            right: -20%;
            top: 0;
            bottom: 0;
            transform: skewX(-45deg) scale(0, 1);
            transition: all 0.5s;
        }

        button:hover:after {
            transform: skewX(-45deg) scale(1, 1);
            -webkit-transition: all 0.5s;
            transition: all 0.5s;
        }

        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            font-family: Arial, sans-serif;
        }

        .input-group {
            margin-bottom: 15px;
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input,
        textarea,
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 4px;
            min-height: 50px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .action-buttons button {
            flex: 1;
        }

        .Caesar,
        .RailFence,
        .Morse,
        .Vigenere,
        .Keyboard {
            margin-top: 20px;
        }

        .text {
            margin-top: 15px;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 4px;
        }

        .active {
            background-color: #444;
        }

        .content-section {
            display: none;
        }

        .active-section {
            display: block;
        }

        /* 摩斯密码表格样式 */
        .morse-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .morse-table th, .morse-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        .morse-table th {
            background-color: #f2f2f2;
        }

        .morse-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        /* 维吉尼亚表格样式 */
        .vigenere-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 14px;
        }

        .vigenere-table th, .vigenere-table td {
            border: 1px solid #ddd;
            padding: 5px;
            text-align: center;
            width: 3.5%;
        }

        .vigenere-table th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        .vigenere-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .vigenere-table td:first-child {
            font-weight: bold;
            background-color: #f2f2f2;
        }

        .example {
            background-color: #e8f4fd;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }

        /* 提示图标样式 */
        .tooltip-icon {
            display: inline-block;
            width: 18px;
            height: 18px;
            background-color: #555;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 18px;
            font-size: 12px;
            margin-left: 5px;
            cursor: help;
            position: relative;
        }

        .tooltip-text {
            visibility: hidden;
            width: 300px;
            background-color: #333;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -150px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 14px;
            font-weight: normal;
            line-height: 1.4;
        }

        .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }

        .tooltip-icon:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 5px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .radio-option input[type="radio"] {
            width: auto;
        }

        .radio-option label {
            display: inline;
            margin-bottom: 0;
            font-weight: normal;
        }

        /* 键盘布局样式 */
        .keyboard-layout {
            width: 100%;
            margin: 15px 0;
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-bottom: 5px;
        }

        .keyboard-key {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-weight: bold;
            box-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }

        .keyboard-key.highlight {
            background-color: #ffeb3b;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="top">
        <button class="btn active" onclick="switchSection('caesar')">凯撒密码</button>
        <button class="btn" onclick="switchSection('railfence')">栅栏密码</button>
        <button class="btn" onclick="switchSection('morse')">摩斯密码</button>
        <button class="btn" onclick="switchSection('vigenere')">维吉尼亚</button>
        <button class="btn" onclick="switchSection('keyboard')">键盘密码</button>
    </div>

    <!-- 凯撒密码部分 -->
    <div id="caesar-section" class="content-section active-section">
        <div class="container">
            <h1>凯撒密码</h1>

            <div class="input-group">
                <label for="inputText">输入文本:</label>
                <textarea id="inputText" rows="3">Hello, World!</textarea>
            </div>

            <div class="input-group">
                <label for="shiftValue">偏移量 (0-25):</label>
                <input type="number" id="shiftValue" min="0" max="25" value="3">
            </div>

            <hr>

            <div class="action-buttons">
                <button class="btn" onclick="encrypt()">加密文本</button>
                <button class="btn" onclick="decrypt()">解密文本</button>
                <button class="btn" onclick="clearAll()">清除</button>
            </div>

            <div class="result" id="result">
                结果将显示在这里...
            </div>
        </div>

        <!-- 凯撒密码介绍 -->
        <div class="Caesar">
            <div class="container">
                <button class="btn" id="CaesarBtn" onclick="introduction('caesar')">显示介绍</button>
                <div class="text" id="CaesarText" style="display: none;">
                    <h2>什么是凯撒密码？</h2>
                    <p>凯撒密码（Caesar cipher）是一种最简单且最广为人知的加密技术。它是一种替换加密的技术，明文中的所有字母都在字母表上向后（或向前）按照一个固定数目进行偏移后被替换成密文。
                    </p>
                    <p>这种加密方法以罗马共和时期恺撒的名字命名，当年恺撒曾用此方法与其将军们进行联系。</p>
                    <h3>历史背景</h3>
                    <p>凯撒密码最早由古罗马军事统帅盖乌斯·尤利乌斯·凯撒所使用，它主要被用来保护重要军事信息。在当时，大多数敌人都是文盲，即使不是文盲，也会被这种字母替换所迷惑。</p>
                    <p>尽管凯撒密码在现代密码学视角下十分简单，但在当时已经足够有效。如今，凯撒密码经常被作为更复杂的加密系统的组成部分，或在教学过程中介绍密码学的基本概念。</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 栅栏密码部分 -->
    <div id="railfence-section" class="content-section">
        <div class="container">
            <h1>栅栏密码</h1>

            <div class="input-group">
                <label for="railInputText">输入文本:</label>
                <textarea id="railInputText" rows="3">Hello, World!</textarea>
            </div>

            <div class="input-group">
                <label for="railsValue">栅栏数 (2-25):</label>
                <input type="number" id="railsValue" min="2" max="25" value="3">
            </div>

            <hr>

            <div class="action-buttons">
                <button class="btn" onclick="railEncrypt()">加密文本</button>
                <button class="btn" onclick="railDecrypt()">解密文本</button>
                <button class="btn" onclick="railClearAll()">清除</button>
            </div>

            <div class="result" id="railResult">
                结果将显示在这里...
            </div>
        </div>

        <!-- 栅栏密码介绍 -->
        <div class="RailFence">
            <div class="container">
                <button class="btn" id="RailFenceBtn" onclick="introduction('railfence')">显示介绍</button>
                <div class="text" id="RailFenceText" style="display: none;">
                    <h2>什么是栅栏密码？</h2>
                    <p>栅栏密码（Rail Fence Cipher）是一种简单的换位密码，它通过将明文中的字符按照特定的模式重新排列来加密信息。</p>
                    <p>这种加密方法将明文写成对角线或锯齿形，然后按行读取来生成密文。栅栏密码的名称来源于其排列方式类似于栅栏。</p>
                    <h3>工作原理</h3>
                    <p>栅栏密码的工作原理是将明文按照一定的行数（栅栏数）写成锯齿形。例如，使用3行栅栏加密"HELLO WORLD"：</p>
                    <pre>
H . . . O . . . R . . 
. E . L .   . O . L . 
. . L . . . W . . . D
                    </pre>
                    <p>然后按行读取：HOR EL OL LWD，得到密文"HOREL OLLWD"。</p>
                    <p>解密时，需要知道栅栏数，然后按照相同的模式重新排列字符恢复原文。</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 摩斯密码部分 -->
    <div id="morse-section" class="content-section">
        <div class="container">
            <h1>摩斯密码</h1>

            <div class="input-group">
                <label for="morseInputText">输入文本:</label>
                <textarea id="morseInputText" rows="3">Hello World</textarea>
            </div>

            <div class="input-group">
                <label for="morseSeparator">分隔符:</label>
                <input type="text" id="morseSeparator" value="/" placeholder="使用 / 分隔单词">
            </div>

            <hr>

            <div class="action-buttons">
                <button class="btn" onclick="morseEncrypt()">加密文本</button>
                <button class="btn" onclick="morseDecrypt()">解密文本</button>
                <button class="btn" onclick="morseClearAll()">清除</button>
            </div>

            <div class="result" id="morseResult">
                结果将显示在这里...
            </div>
        </div>

        <!-- 摩斯密码介绍 -->
        <div class="Morse">
            <div class="container">
                <button class="btn" id="MorseBtn" onclick="introduction('morse')">显示介绍</button>
                <div class="text" id="MorseText" style="display: none;">
                    <h2>什么是摩斯密码？</h2>
                    <p>摩斯密码（Morse Code）是一种时通时断的信号代码，通过不同的排列顺序来表达不同的英文字母、数字和标点符号。</p>
                    <p>它由美国人萨缪尔·摩斯在1836年发明，最初用于电报通信。摩斯密码由两种基本信号组成：短促的点信号（·）和保持一定时间的长信号（—）。</p>

                    <h3>摩斯密码表</h3>
                    <table class="morse-table">
                        <tr>
                            <th>字符</th>
                            <th>摩斯码</th>
                            <th>字符</th>
                            <th>摩斯码</th>
                            <th>字符</th>
                            <th>摩斯码</th>
                        </tr>
                        <tr>
                            <td>A</td>
                            <td>·-</td>
                            <td>B</td>
                            <td>-···</td>
                            <td>C</td>
                            <td>-·-·</td>
                        </tr>
                        <tr>
                            <td>D</td>
                            <td>-··</td>
                            <td>E</td>
                            <td>·</td>
                            <td>F</td>
                            <td>··-·</td>
                        </tr>
                        <tr>
                            <td>G</td>
                            <td>--·</td>
                            <td>H</td>
                            <td>····</td>
                            <td>I</td>
                            <td>··</td>
                        </tr>
                        <tr>
                            <td>J</td>
                            <td>·---</td>
                            <td>K</td>
                            <td>-·-</td>
                            <td>L</td>
                            <td>·-··</td>
                        </tr>
                        <tr>
                            <td>M</td>
                            <td>--</td>
                            <td>N</td>
                            <td>-·</td>
                            <td>O</td>
                            <td>---</td>
                        </tr>
                        <tr>
                            <td>P</td>
                            <td>·--·</td>
                            <td>Q</td>
                            <td>--·-</td>
                            <td>R</td>
                            <td>·-·</td>
                        </tr>
                        <tr>
                            <td>S</td>
                            <td>···</td>
                            <td>T</td>
                            <td>-</td>
                            <td>U</td>
                            <td>··-</td>
                        </tr>
                        <tr>
                            <td>V</td>
                            <td>···-</td>
                            <td>W</td>
                            <td>·--</td>
                            <td>X</td>
                            <td>-··-</td>
                        </tr>
                        <tr>
                            <td>Y</td>
                            <td>-·--</td>
                            <td>Z</td>
                            <td>--··</td>
                            <td>0</td>
                            <td>-----</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>·----</td>
                            <td>2</td>
                            <td>··---</td>
                            <td>3</td>
                            <td>···--</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>····-</td>
                            <td>5</td>
                            <td>·····</td>
                            <td>6</td>
                            <td>-····</td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td>--···</td>
                            <td>8</td>
                            <td>---··</td>
                            <td>9</td>
                            <td>----·</td>
                        </tr>
                    </table>

                    <h3>历史背景</h3>
                    <p>摩斯密码在19世纪和20世纪初被广泛用于电报通信，特别是在军事和航海领域。即使在现代，摩斯密码仍然被用作紧急求救信号（SOS：··· --- ···）。</p>
                    <p>摩斯密码的优势在于它只需要两种状态（开/关、长/短）就可以传递信息，这使得它非常适合在恶劣环境下使用，如无线电通信、灯光信号等。</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 维吉尼亚密码部分 -->
    <div id="vigenere-section" class="content-section">
        <div class="container">
            <h1>维吉尼亚密码</h1>

            <div class="input-group">
                <label for="vigenereInputText">输入文本:</label>
                <textarea id="vigenereInputText" rows="3">Hello World</textarea>
            </div>

            <div class="input-group">
                <label for="vigenereKey">
                    密钥:
                    <span class="tooltip-icon">?
                        <span class="tooltip-text">
                            <strong>密钥说明:</strong><br>
                            • 密钥应由字母组成，不区分大小写<br>
                            • 在自动密钥模式下：若密钥长度小于明文，则使用明文自身作为后续密钥<br>
                            • 在重复密钥模式下：密钥会重复使用直到覆盖整个明文<br>
                            • 示例: 明文"HELLO" + 密钥"KEY" = 密文"RIJVS"
                        </span>
                    </span>
                </label>
                <input type="text" id="vigenereKey" value="KEY" placeholder="输入密钥（仅字母）">
            </div>

            <div class="input-group">
                <label>
                    模式:
                    <span class="tooltip-icon">?
                        <span class="tooltip-text">
                            <strong>模式说明:</strong><br>
                            • <strong>自动密钥模式:</strong> 使用原始密钥后，用明文的剩余部分作为后续密钥<br>
                            &nbsp;&nbsp;示例: 明文"HELLO" + 密钥"KEY" → 实际密钥"KEYHE"<br>
                            • <strong>重复密钥模式:</strong> 重复使用原始密钥直到覆盖整个明文<br>
                            &nbsp;&nbsp;示例: 明文"HELLO" + 密钥"KEY" → 实际密钥"KEYKE"
                        </span>
                    </span>
                </label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="autoKey" name="keyMode" value="auto" checked>
                        <label for="autoKey">自动密钥</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="repeatKey" name="keyMode" value="repeat">
                        <label for="repeatKey">重复密钥</label>
                    </div>
                </div>
            </div>

            <hr>

            <div class="action-buttons">
                <button class="btn" onclick="vigenereEncrypt()">加密文本</button>
                <button class="btn" onclick="vigenereDecrypt()">解密文本</button>
                <button class="btn" onclick="vigenereClearAll()">清除</button>
            </div>

            <div class="result" id="vigenereResult">
                结果将显示在这里...
            </div>
        </div>

        <!-- 维吉尼亚密码介绍 -->
        <div class="Vigenere">
            <div class="container">
                <button class="btn" id="VigenereBtn" onclick="introduction('vigenere')">显示介绍</button>
                <div class="text" id="VigenereText" style="display: none;">
                    <h2>什么是维吉尼亚密码？</h2>
                    <p>维吉尼亚密码（Vigenère Cipher）是一种多表替换密码，由法国外交官布莱斯·德·维吉尼亚在16世纪发明。它被认为是凯撒密码的加强版，通过使用不同的凯撒密码表来增强安全性。
                    </p>

                    <h3>工作原理</h3>
                    <p>维吉尼亚密码使用一个关键词（密钥）来决定每个字母使用哪个凯撒密码表进行加密：</p>

                    <div class="example">
                        <p><strong>示例：</strong></p>
                        <p>明文：HELLO</p>
                        <p>密钥：KEY</p>
                        <p>加密过程：</p>
                        <ul>
                            <li>H (第1个字母) + K (密钥第1个字母) = R</li>
                            <li>E (第2个字母) + E (密钥第2个字母) = I</li>
                            <li>L (第3个字母) + Y (密钥第3个字母) = J</li>
                            <li>L (第4个字母) + K (密钥第1个字母，重复) = V</li>
                            <li>O (第5个字母) + E (密钥第2个字母，重复) = S</li>
                        </ul>
                        <p>密文：RIJVS</p>
                    </div>

                    <h3>维吉尼亚方阵</h3>
                    <table class="vigenere-table">
                        <tr>
                            <th></th>
                            <th>A</th>
                            <th>B</th>
                            <th>C</th>
                            <th>D</th>
                            <th>E</th>
                            <th>F</th>
                            <th>G</th>
                            <th>H</th>
                            <th>I</th>
                            <th>J</th>
                            <th>K</th>
                            <th>L</th>
                            <th>M</th>
                            <th>N</th>
                            <th>O</th>
                            <th>P</th>
                            <th>Q</th>
                            <th>R</th>
                            <th>S</th>
                            <th>T</th>
                            <th>U</th>
                            <th>V</th>
                            <th>W</th>
                            <th>X</th>
                            <th>Y</th>
                            <th>Z</th>
                        </tr>
                        <tr>
                            <td>A</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                        </tr>
                        <tr>
                            <td>B</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                        </tr>
                        <tr>
                            <td>C</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                        </tr>
                        <tr>
                            <td>D</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                        </tr>
                        <tr>
                            <td>E</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                        </tr>
                        <tr>
                            <td>F</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                        </tr>
                        <tr>
                            <td>G</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                        </tr>
                        <tr>
                            <td>H</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                        </tr>
                        <tr>
                            <td>I</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                        </tr>
                        <tr>
                            <td>J</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                        </tr>
                        <tr>
                            <td>K</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                        </tr>
                        <tr>
                            <td>L</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                        </tr>
                        <tr>
                            <td>M</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                        </tr>
                        <tr>
                            <td>N</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                        </tr>
                        <tr>
                            <td>O</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                        </tr>
                        <tr>
                            <td>P</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                        </tr>
                        <tr>
                            <td>Q</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                        </tr>
                        <tr>
                            <td>R</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                        </tr>
                        <tr>
                            <td>S</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                        </tr>
                        <tr>
                            <td>T</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                        </tr>
                        <tr>
                            <td>U</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                        </tr>
                        <tr>
                            <td>V</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                        </tr>
                        <tr>
                            <td>W</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                        </tr>
                        <tr>
                            <td>X</td>
                            <td>X</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                        </tr>
                        <tr>
                            <td>Y</td>
                            <td>Y</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                        </tr>
                        <tr>
                            <td>Z</td>
                            <td>Z</td>
                            <td>A</td>
                            <td>B</td>
                            <td>C</td>
                            <td>D</td>
                            <td>E</td>
                            <td>F</td>
                            <td>G</td>
                            <td>H</td>
                            <td>I</td>
                            <td>J</td>
                            <td>K</td>
                            <td>L</td>
                            <td>M</td>
                            <td>N</td>
                            <td>O</td>
                            <td>P</td>
                            <td>Q</td>
                            <td>R</td>
                            <td>S</td>
                            <td>T</td>
                            <td>U</td>
                            <td>V</td>
                            <td>W</td>
                            <td>X</td>
                            <td>Y</td>
                        </tr>
                    </table>

                    <h3>历史背景</h3>
                    <p>维吉尼亚密码在16世纪被发明后，曾被认为是"不可破解的密码"，直到19世纪才被查尔斯·巴贝奇和弗里德里希·卡西斯基独立破解。它的安全性在于使用多个凯撒密码表，使得频率分析更加困难。
                    </p>
                    <p>维吉尼亚密码在历史上曾被广泛使用，特别是在外交和军事通信中，直到20世纪初被更安全的密码系统取代。</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 键盘密码部分 -->
    <div id="keyboard-section" class="content-section">
        <div class="container">
            <h1>键盘密码</h1>

            <div class="input-group">
                <label for="keyboardInputText">输入文本:</label>
                <textarea id="keyboardInputText" rows="3">Hello World</textarea>
            </div>

            <div class="input-group">
                <label for="keyboardLayout">键盘布局:</label>
                <select id="keyboardLayout">
                    <option value="qwerty">QWERTY (标准英文)</option>
                    <option value="azerty">AZERTY (法式)</option>
                    <option value="qwertz">QWERTZ (德式)</option>
                </select>
            </div>

            <div class="input-group">
                <label>替换方向:</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="shiftLeft" name="shiftDirection" value="left" checked>
                        <label for="shiftLeft">向左移位</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="shiftRight" name="shiftDirection" value="right">
                        <label for="shiftRight">向右移位</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="shiftUp" name="shiftDirection" value="up">
                        <label for="shiftUp">向上移位</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="shiftDown" name="shiftDirection" value="down">
                        <label for="shiftDown">向下移位</label>
                    </div>
                </div>
            </div>

            <div class="input-group">
                <label>当前键盘布局:</label>
                <div id="keyboardDisplay" class="keyboard-layout">
                    <!-- 键盘布局将通过JavaScript动态生成 -->
                </div>
            </div>

            <hr>

            <div class="action-buttons">
                <button class="btn" onclick="keyboardEncrypt()">加密文本</button>
                <button class="btn" onclick="keyboardDecrypt()">解密文本</button>
                <button class="btn" onclick="keyboardClearAll()">清除</button>
            </div>

            <div class="result" id="keyboardResult">
                结果将显示在这里...
            </div>
        </div>

        <!-- 键盘密码介绍 -->
        <div class="Keyboard">
            <div class="container">
                <button class="btn" id="KeyboardBtn" onclick="introduction('keyboard')">显示介绍</button>
                <div class="text" id="KeyboardText" style="display: none;">
                    <h2>什么是键盘密码？</h2>
                    <p>键盘密码（Keyboard Cipher）是一种基于键盘布局的替换密码。它通过将键盘上的每个字母替换为相邻位置的字母来实现加密。</p>
                    <p>这种密码方法利用了标准键盘布局（如QWERTY、AZERTY等）的特点，将明文字母按照特定方向（左、右、上、下）在键盘上移动，从而生成密文。</p>
                    
                    <h3>工作原理</h3>
                    <p>键盘密码的工作原理非常简单：</p>
                    <ul>
                        <li>选择一个键盘布局（如标准QWERTY布局）</li>
                        <li>选择一个移动方向（左、右、上、下）</li>
                        <li>将每个字母按照选定方向在键盘上移动一位</li>
                        <li>如果移动后超出键盘边界，则保持不变</li>
                    </ul>
                    
                    <div class="example">
                        <p><strong>示例（使用QWERTY布局，向左移位）：</strong></p>
                        <p>明文：HELLO</p>
                        <p>加密过程：</p>
                        <ul>
                            <li>H → 向左移动 → G</li>
                            <li>E → 向左移动 → W</li>
                            <li>L → 向左移动 → K</li>
                            <li>L → 向左移动 → K</li>
                            <li>O → 向左移动 → I</li>
                        </ul>
                        <p>密文：GWKKI</p>
                    </div>
                    
                    <h3>支持的键盘布局</h3>
                    <p>本工具支持三种常见的键盘布局：</p>
                    <ul>
                        <li><strong>QWERTY</strong>：标准英文键盘布局，是最常见的键盘布局</li>
                        <li><strong>AZERTY</strong>：法式键盘布局，主要在法国和比利时使用</li>
                        <li><strong>QWERTZ</strong>：德式键盘布局，主要在德国和东欧国家使用</li>
                    </ul>
                    
                    <h3>历史背景</h3>
                    <p>键盘密码是一种相对现代的密码方法，它的出现与计算机键盘的普及密切相关。虽然它不具备很高的安全性，但作为一种简单的替换密码，它经常被用于谜题、游戏和教学场景。</p>
                    <p>键盘密码的优势在于其简单直观，不需要复杂的计算或密钥管理。然而，由于键盘布局是公开的，这种密码很容易被破解，因此不适合保护重要信息。</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 切换部分显示
        function switchSection(section) {
            // 隐藏所有部分
            document.querySelectorAll('.content-section').forEach(el => {
                el.classList.remove('active-section');
            });
            
            // 移除所有按钮的活动状态
            document.querySelectorAll('.top .btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // 显示选中的部分
            document.getElementById(section + '-section').classList.add('active-section');
            
            // 设置按钮活动状态
            event.target.classList.add('active');
            
            // 如果是键盘密码部分，更新键盘显示
            if (section === 'keyboard') {
                updateKeyboardDisplay();
            }
        }
        
        // 显示/隐藏介绍
        function introduction(type) {
            let btn, text;
            
            if (type === 'caesar') {
                btn = document.getElementById('CaesarBtn');
                text = document.getElementById('CaesarText');
            } else if (type === 'railfence') {
                btn = document.getElementById('RailFenceBtn');
                text = document.getElementById('RailFenceText');
            } else if (type === 'morse') {
                btn = document.getElementById('MorseBtn');
                text = document.getElementById('MorseText');
            } else if (type === 'vigenere') {
                btn = document.getElementById('VigenereBtn');
                text = document.getElementById('VigenereText');
            } else if (type === 'keyboard') {
                btn = document.getElementById('KeyboardBtn');
                text = document.getElementById('KeyboardText');
            }
            
            if (text.style.display === "none") {
                text.style.display = "";
                btn.textContent = "隐藏介绍";
            } else {
                text.style.display = "none";
                btn.textContent = "显示介绍";
            }
        }
        
        // 凯撒密码函数
        function caesarCipher(text, shift, encrypt = true) {
            if (!encrypt) {
                shift = (26 - shift) % 26;
            }
            
            let result = '';
            
            for (let i = 0; i < text.length; i++) {
                let char = text[i];
                
                // 处理大写字母
                if (char >= 'A' && char <= 'Z') {
                    result += String.fromCharCode((char.charCodeAt(0) - 65 + shift) % 26 + 65);
                }
                // 处理小写字母
                else if (char >= 'a' && char <= 'z') {
                    result += String.fromCharCode((char.charCodeAt(0) - 97 + shift) % 26 + 97);
                }
                // 非字母字符保持不变
                else {
                    result += char;
                }
            }
            
            return result;
        }
        
        // 凯撒加密函数
        function encrypt() {
            const inputText = document.getElementById('inputText').value;
            const shiftValue = parseInt(document.getElementById('shiftValue').value);
            
            if (isNaN(shiftValue) || shiftValue < 0 || shiftValue > 25) {
                alert('请输入0-25之间的有效偏移量');
                return;
            }
            
            const encryptedText = caesarCipher(inputText, shiftValue, true);
            document.getElementById('result').textContent = encryptedText;
        }
        
        // 凯撒解密函数
        function decrypt() {
            const inputText = document.getElementById('inputText').value;
            const shiftValue = parseInt(document.getElementById('shiftValue').value);
            
            if (isNaN(shiftValue) || shiftValue < 0 || shiftValue > 25) {
                alert('请输入0-25之间的有效偏移量');
                return;
            }
            
            const decryptedText = caesarCipher(inputText, shiftValue, false);
            document.getElementById('result').textContent = decryptedText;
        }
        
        // 凯撒清除函数
        function clearAll() {
            document.getElementById('inputText').value = '';
            document.getElementById('shiftValue').value = '3';
            document.getElementById('result').textContent = '结果将显示在这里...';
        }
        
        // 栅栏密码加密函数
        function railFenceEncrypt(text, rails) {
            // 创建栅栏数组
            let fence = [];
            for (let i = 0; i < rails; i++) {
                fence.push([]);
            }
            
            let rail = 0;
            let direction = 1; // 1表示向下，-1表示向上
            
            // 将字符放入栅栏中
            for (let i = 0; i < text.length; i++) {
                fence[rail].push(text[i]);
                
                // 改变方向
                if (rail === 0) {
                    direction = 1;
                } else if (rail === rails - 1) {
                    direction = -1;
                }
                
                rail += direction;
            }
            
            // 按行读取栅栏
            let result = '';
            for (let i = 0; i < rails; i++) {
                result += fence[i].join('');
            }
            
            return result;
        }
        
        // 栅栏密码解密函数
        function railFenceDecrypt(text, rails) {
            // 创建栅栏模式
            let fence = [];
            for (let i = 0; i < rails; i++) {
                fence.push([]);
            }
            
            let rail = 0;
            let direction = 1;
            
            // 创建栅栏模式（标记位置）
            for (let i = 0; i < text.length; i++) {
                fence[rail].push(null);
                
                // 改变方向
                if (rail === 0) {
                    direction = 1;
                } else if (rail === rails - 1) {
                    direction = -1;
                }
                
                rail += direction;
            }
            
            // 将密文字符填入栅栏
            let index = 0;
            for (let i = 0; i < rails; i++) {
                for (let j = 0; j < fence[i].length; j++) {
                    fence[i][j] = text[index++];
                }
            }
            
            // 按原始顺序读取字符
            let result = '';
            rail = 0;
            direction = 1;
            
            for (let i = 0; i < text.length; i++) {
                result += fence[rail].shift();
                
                // 改变方向
                if (rail === 0) {
                    direction = 1;
                } else if (rail === rails - 1) {
                    direction = -1;
                }
                
                rail += direction;
            }
            
            return result;
        }
        
        // 栅栏加密函数
        function railEncrypt() {
            const inputText = document.getElementById('railInputText').value;
            const railsValue = parseInt(document.getElementById('railsValue').value);
            
            if (isNaN(railsValue) || railsValue < 2 || railsValue > 25) {
                alert('请输入2-25之间的有效栅栏数');
                return;
            }
            
            const encryptedText = railFenceEncrypt(inputText, railsValue);
            document.getElementById('railResult').textContent = encryptedText;
        }
        
        // 栅栏解密函数
        function railDecrypt() {
            const inputText = document.getElementById('railInputText').value;
            const railsValue = parseInt(document.getElementById('railsValue').value);
            
            if (isNaN(railsValue) || railsValue < 2 || railsValue > 25) {
                alert('请输入2-25之间的有效栅栏数');
                return;
            }
            
            const decryptedText = railFenceDecrypt(inputText, railsValue);
            document.getElementById('railResult').textContent = decryptedText;
        }
        
        // 栅栏清除函数
        function railClearAll() {
            document.getElementById('railInputText').value = '';
            document.getElementById('railsValue').value = '3';
            document.getElementById('railResult').textContent = '结果将显示在这里...';
        }
        
        // 摩斯密码字典
        const morseCode = {
            'A': '.-', 'B': '-...', 'C': '-.-.',
            'D': '-..', 'E': '.', 'F': '..-.',
            'G': '--.', 'H': '....', 'I': '..',
            'J': '.---', 'K': '-.-', 'L': '.-..',
            'M': '--', 'N': '-.', 'O': '---',
            'P': '.--.', 'Q': '--.-', 'R': '.-.',
            'S': '...', 'T': '-', 'U': '..-',
            'V': '...-', 'W': '.--', 'X': '-..-',
            'Y': '-.--', 'Z': '--..',
            '0': '-----', '1': '.----', '2': '..---',
            '3': '...--', '4': '....-', '5': '.....',
            '6': '-....', '7': '--...', '8': '---..',
            '9': '----.',
            '.': '.-.-.-', ',': '--..--', '?': '..--..',
            "'": '.----.', '!': '-.-.--', '/': '-..-.',
            '(': '-.--.', ')': '-.--.-', '&': '.-...',
            ':': '---...', ';': '-.-.-.', '=': '-...-',
            '+': '.-.-.', '-': '-....-', '_': '..--.-',
            '"': '.-..-.', '$': '...-..-', '@': '.--.-.',
            ' ': '/'
        };
        
        // 反转字典用于解密
        const reverseMorseCode = {};
        for (const [key, value] of Object.entries(morseCode)) {
            reverseMorseCode[value] = key;
        }
        
        // 摩斯密码加密函数
        function morseEncrypt() {
            const inputText = document.getElementById('morseInputText').value.toUpperCase();
            const separator = document.getElementById('morseSeparator').value || '/';
            
            let result = '';
            
            for (let i = 0; i < inputText.length; i++) {
                const char = inputText[i];
                
                if (morseCode[char]) {
                    result += morseCode[char] + ' ';
                } else if (char === ' ') {
                    result += separator + ' ';
                } else {
                    // 对于不在字典中的字符，保留原样
                    result += char + ' ';
                }
            }
            
            document.getElementById('morseResult').textContent = result.trim();
        }
        
        // 摩斯密码解密函数
        function morseDecrypt() {
            const inputText = document.getElementById('morseInputText').value.trim();
            const separator = document.getElementById('morseSeparator').value || '/';
            
            // 将分隔符标准化为空格
            const normalizedInput = inputText.replace(new RegExp('\\' + separator, 'g'), ' / ');
            
            // 分割摩斯码
            const morseWords = normalizedInput.split(' / ');
            let result = '';
            
            for (let i = 0; i < morseWords.length; i++) {
                const morseChars = morseWords[i].split(' ');
                
                for (let j = 0; j < morseChars.length; j++) {
                    const morseChar = morseChars[j].trim();
                    
                    if (morseChar === '') continue;
                    
                    if (reverseMorseCode[morseChar]) {
                        result += reverseMorseCode[morseChar];
                    } else {
                        // 对于无法解码的字符，保留原样
                        result += morseChar;
                    }
                }
                
                // 在单词之间添加空格
                if (i < morseWords.length - 1) {
                    result += ' ';
                }
            }
            
            document.getElementById('morseResult').textContent = result;
        }
        
        // 摩斯密码清除函数
        function morseClearAll() {
            document.getElementById('morseInputText').value = '';
            document.getElementById('morseSeparator').value = '/';
            document.getElementById('morseResult').textContent = '结果将显示在这里...';
        }
        
        // 维吉尼亚密码函数
        function vigenereCipher(text, key, encrypt = true) {
            // 过滤非字母字符，但保留位置信息
            let cleanText = '';
            let nonAlphaPositions = [];
            
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                if (/[a-zA-Z]/.test(char)) {
                    cleanText += char.toUpperCase();
                } else {
                    nonAlphaPositions.push({ index: i, char: char });
                }
            }
            
            // 处理密钥
            let cleanKey = key.toUpperCase().replace(/[^A-Z]/g, '');
            if (cleanKey.length === 0) {
                alert('请输入有效的密钥（至少包含一个字母）');
                return text;
            }
            
            // 获取密钥模式
            const keyMode = document.querySelector('input[name="keyMode"]:checked').value;
            let extendedKey = cleanKey;
            
            if (keyMode === 'repeat') {
                // 重复密钥模式
                while (extendedKey.length < cleanText.length) {
                    extendedKey += cleanKey;
                }
                extendedKey = extendedKey.substring(0, cleanText.length);
            } else {
                // 自动密钥模式
                if (encrypt) {
                    extendedKey = cleanKey + cleanText.substring(0, cleanText.length - cleanKey.length);
                } else {
                    // 解密时自动密钥模式需要特殊处理
                    extendedKey = cleanKey;
                    let decryptedSoFar = '';
                    
                    for (let i = 0; i < Math.min(cleanKey.length, cleanText.length); i++) {
                        const keyChar = extendedKey[i];
                        const textChar = cleanText[i];
                        
                        // 解密当前字符
                        let decryptedChar = '';
                        if (textChar >= 'A' && textChar <= 'Z') {
                            const shift = keyChar.charCodeAt(0) - 65;
                            let newCharCode = textChar.charCodeAt(0) - shift;
                            if (newCharCode < 65) newCharCode += 26;
                            decryptedChar = String.fromCharCode(newCharCode);
                        } else {
                            decryptedChar = textChar;
                        }
                        
                        decryptedSoFar += decryptedChar;
                    }
                    
                    extendedKey = cleanKey + decryptedSoFar;
                    if (extendedKey.length < cleanText.length) {
                        extendedKey += cleanText.substring(0, cleanText.length - extendedKey.length);
                    }
                    extendedKey = extendedKey.substring(0, cleanText.length);
                }
            }
            
            let result = '';
            let textIndex = 0;
            
            for (let i = 0; i < text.length; i++) {
                // 检查当前位置是否有非字母字符
                const nonAlpha = nonAlphaPositions.find(pos => pos.index === i);
                if (nonAlpha) {
                    result += nonAlpha.char;
                    continue;
                }
                
                const textChar = cleanText[textIndex];
                const keyChar = extendedKey[textIndex];
                textIndex++;
                
                if (textChar >= 'A' && textChar <= 'Z') {
                    const textCode = textChar.charCodeAt(0) - 65;
                    const keyCode = keyChar.charCodeAt(0) - 65;
                    
                    let newCode;
                    if (encrypt) {
                        newCode = (textCode + keyCode) % 26;
                    } else {
                        newCode = (textCode - keyCode + 26) % 26;
                    }
                    
                    result += String.fromCharCode(newCode + 65);
                } else {
                    result += textChar;
                }
            }
            
            return result;
        }
        
        // 维吉尼亚加密函数
        function vigenereEncrypt() {
            const inputText = document.getElementById('vigenereInputText').value;
            const key = document.getElementById('vigenereKey').value;
            
            if (!key.trim()) {
                alert('请输入密钥');
                return;
            }
            
            const encryptedText = vigenereCipher(inputText, key, true);
            document.getElementById('vigenereResult').textContent = encryptedText;
        }
        
        // 维吉尼亚解密函数
        function vigenereDecrypt() {
            const inputText = document.getElementById('vigenereInputText').value;
            const key = document.getElementById('vigenereKey').value;
            
            if (!key.trim()) {
                alert('请输入密钥');
                return;
            }
            
            const decryptedText = vigenereCipher(inputText, key, false);
            document.getElementById('vigenereResult').textContent = decryptedText;
        }
        
        // 维吉尼亚清除函数
        function vigenereClearAll() {
            document.getElementById('vigenereInputText').value = '';
            document.getElementById('vigenereKey').value = 'KEY';
            document.getElementById('vigenereResult').textContent = '结果将显示在这里...';
        }
        
        // 键盘布局定义
        const keyboardLayouts = {
            qwerty: [
                ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],
                ['Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P'],
                ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L'],
                ['Z', 'X', 'C', 'V', 'B', 'N', 'M']
            ],
            azerty: [
                ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],
                ['A', 'Z', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P'],
                ['Q', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L', 'M'],
                ['W', 'X', 'C', 'V', 'B', 'N']
            ],
            qwertz: [
                ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],
                ['Q', 'W', 'E', 'R', 'T', 'Z', 'U', 'I', 'O', 'P'],
                ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L'],
                ['Y', 'X', 'C', 'V', 'B', 'N', 'M']
            ]
        };
        
        // 更新键盘显示
        function updateKeyboardDisplay() {
            const layoutSelect = document.getElementById('keyboardLayout');
            const selectedLayout = layoutSelect.value;
            const keyboardDisplay = document.getElementById('keyboardDisplay');
            
            // 清空当前显示
            keyboardDisplay.innerHTML = '';
            
            // 获取选定的键盘布局
            const layout = keyboardLayouts[selectedLayout];
            
            // 创建键盘行
            layout.forEach(row => {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'keyboard-row';
                
                row.forEach(key => {
                    const keyDiv = document.createElement('div');
                    keyDiv.className = 'keyboard-key';
                    keyDiv.textContent = key;
                    rowDiv.appendChild(keyDiv);
                });
                
                keyboardDisplay.appendChild(rowDiv);
            });
        }
        
        // 键盘密码加密/解密函数
        function keyboardCipher(text, direction, encrypt = true) {
            const layoutSelect = document.getElementById('keyboardLayout');
            const selectedLayout = layoutSelect.value;
            const layout = keyboardLayouts[selectedLayout];
            
            // 创建字符位置映射
            const charPositions = {};
            layout.forEach((row, rowIndex) => {
                row.forEach((char, colIndex) => {
                    charPositions[char.toUpperCase()] = { row: rowIndex, col: colIndex };
                    charPositions[char.toLowerCase()] = { row: rowIndex, col: colIndex };
                });
            });
            
            let result = '';
            
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                
                // 如果字符不在键盘布局中，保持不变
                if (!charPositions[char]) {
                    result += char;
                    continue;
                }
                
                const { row, col } = charPositions[char];
                let newRow = row;
                let newCol = col;
                
                // 根据方向计算新位置
                if (direction === 'left') {
                    newCol = encrypt ? col - 1 : col + 1;
                } else if (direction === 'right') {
                    newCol = encrypt ? col + 1 : col - 1;
                } else if (direction === 'up') {
                    newRow = encrypt ? row - 1 : row + 1;
                } else if (direction === 'down') {
                    newRow = encrypt ? row + 1 : row - 1;
                }
                
                // 检查新位置是否有效
                let newChar = char;
                if (newRow >= 0 && newRow < layout.length && 
                    newCol >= 0 && newCol < layout[newRow].length) {
                    newChar = layout[newRow][newCol];
                    
                    // 保持原始大小写
                    if (char === char.toLowerCase()) {
                        newChar = newChar.toLowerCase();
                    }
                }
                
                result += newChar;
            }
            
            return result;
        }
        
        // 键盘加密函数
        function keyboardEncrypt() {
            const inputText = document.getElementById('keyboardInputText').value;
            const direction = document.querySelector('input[name="shiftDirection"]:checked').value;
            
            const encryptedText = keyboardCipher(inputText, direction, true);
            document.getElementById('keyboardResult').textContent = encryptedText;
        }
        
        // 键盘解密函数
        function keyboardDecrypt() {
            const inputText = document.getElementById('keyboardInputText').value;
            const direction = document.querySelector('input[name="shiftDirection"]:checked').value;
            
            const decryptedText = keyboardCipher(inputText, direction, false);
            document.getElementById('keyboardResult').textContent = decryptedText;
        }
        
        // 键盘清除函数
        function keyboardClearAll() {
            document.getElementById('keyboardInputText').value = '';
            document.getElementById('keyboardResult').textContent = '结果将显示在这里...';
        }
        
        // 页面加载时初始化键盘显示
        document.addEventListener('DOMContentLoaded', function() {
            updateKeyboardDisplay();
            
            // 监听键盘布局变化
            document.getElementById('keyboardLayout').addEventListener('change', updateKeyboardDisplay);
        });
    </script>
</body>
</html>